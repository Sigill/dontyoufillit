Date.now||(Date.now=function(){return(new Date).getTime()});
(function(){for(var a=["webkit","moz"],c=0;c<a.length&&!window.requestAnimationFrame;++c){var b=a[c];window.requestAnimationFrame=window[b+"RequestAnimationFrame"];window.cancelAnimationFrame=window[b+"CancelAnimationFrame"]||window[b+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var d=0;window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(d+16,b);return setTimeout(function(){a(d=
c)},c-b)};window.cancelAnimationFrame=clearTimeout}})();var supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("testPassive",null,opts);window.removeEventListener("testPassive",null,opts)}catch(e$$12){};(function(a,c){"object"===typeof exports&&"undefined"!==typeof module?module.exports=c():"function"===typeof define&&define.amd?define(c):a.Stats=c()})(this,function(){var a=function(){function c(a){h.appendChild(a.dom);return a}function b(a){for(var b=0;b<h.children.length;b++)h.children[b].style.display=b===a?"block":"none";f=a}function d(){return performance&&performance.now?performance.now():Date.now()}var f=0,h=document.createElement("div");h.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";
h.addEventListener("click",function(a){a.preventDefault();b(++f%h.children.length)},!1);var n=d(),g=n,s=0,w=c(new a.Panel("FPS","#0ff","#002")),y=c(new a.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=c(new a.Panel("MB","#f08","#201"));b(0);return{REVISION:16,dom:h,addPanel:c,showPanel:b,begin:function(){n=d()},end:function(){s++;var a=d();y.update(a-n,200);if(a>=g+1E3&&(w.update(1E3*s/(a-g),100),g=a,s=0,u)){var b=performance.memory;u.update(b.usedJSHeapSize/1048576,
b.jsHeapSizeLimit/1048576)}return a},update:function(){n=this.end()},domElement:h,setMode:b}};a.Panel=function(a,b,d){var f=Infinity,h=0,n=Math.round,g=n(window.devicePixelRatio||1),s=80*g,w=48*g,y=3*g,u=2*g,t=3*g,r=15*g,q=74*g,v=30*g,p=document.createElement("canvas");p.width=s;p.height=w;p.style.cssText="width:80px;height:48px";var e=p.getContext("2d");e.font="bold "+9*g+"px Helvetica,Arial,sans-serif";e.textBaseline="top";e.fillStyle=d;e.fillRect(0,0,s,w);e.fillStyle=b;e.fillText(a,y,u);e.fillRect(t,
r,q,v);e.fillStyle=d;e.globalAlpha=0.9;e.fillRect(t,r,q,v);return{dom:p,update:function(x,w){f=Math.min(f,x);h=Math.max(h,x);e.fillStyle=d;e.globalAlpha=1;e.fillRect(0,0,s,r);e.fillStyle=b;e.fillText(n(x)+" "+a+" ("+n(f)+"-"+n(h)+")",y,u);e.drawImage(p,t+g,r,q-g,v,t,r,q-g,v);e.fillRect(t+q-g,r,g,v);e.fillStyle=d;e.globalAlpha=0.9;e.fillRect(t+q-g,r,g,n((1-x/w)*v))}}};return a});function Observable(){this.observers=[]}Observable.prototype.addObserver=function(a){this.observers.push(a)};Observable.prototype.removeObserver=function(a){a=this.observers.indexOf(a);~a&&this.observers.splice(a,1)};Observable.prototype.notifyObservers=function(){for(var a=this.observers.length-1;0<=a;a--)this.observers[a].apply(null,arguments)};Math.sign||(Math.__proto__.sign=function(a){return isNaN(a)?NaN:0===a?a:0<a?1:-1});function vectorLength(a,c){return Math.sqrt(a*a+c*c)}function RK41DObject_State(a,c){this.u=a;this.s=c}function RK41DObject_Derivative(a,c){this.du=a;this.ds=c}function RK41DObject(){this.state=new RK41DObject_State(0,0)}
RK41DObject.prototype.evaluate=function(a,c,b,d){if("undefined"==typeof b)return new RK41DObject_Derivative(a.s,this.acceleration(a,c));a=new RK41DObject_State(a.u+d.du*b,a.s+d.ds*b);return new RK41DObject_Derivative(a.s,this.acceleration(a,c+b))};
RK41DObject.prototype.integrate=function(a,c){var b=this.evaluate(this.state,a),d=this.evaluate(this.state,a,0.5*c,b),f=this.evaluate(this.state,a,0.5*c,d),h=this.evaluate(this.state,a,c,f),n=1/6*(b.ds+2*(d.ds+f.ds)+h.ds);this.state.u+=1/6*(b.du+2*(d.du+f.du)+h.du)*c;this.state.s+=n*c};function normalizeRadian(a){for(;a>2*Math.PI;)a-=2*Math.PI;for(;0>a;)a+=2*Math.PI;return a}function Cannon(){RK41DObject.call(this);this.state.u=0;this.state.s=Math.PI/3}Cannon.prototype=new RK41DObject;
Cannon.prototype.constructor=RK41DObject;Cannon.prototype.acceleration=function(a,c){return 0};Cannon.prototype.getAngle=function(){return this.state.u+Math.PI/2};Cannon.prototype.update=function(a,c){this.integrate(a,c);Math.abs(this.state.u)>=Math.PI/2&&(this.state.u=(Math.PI/2-Math.abs(Math.PI/2-Math.abs(this.state.u)))*Math.sign(this.state.u),this.state.s*=-1)};
function Ball(a,c,b,d){RK41DObject.call(this);this.nr=a;this.nx=c;this.ny=b;this.direction=d;this.state.u=0;this.state.s=1;this.counter=3}Ball.prototype=new RK41DObject;Ball.prototype.constructor=RK41DObject;Ball.prototype.acceleration=function(a,c){return-0.4};Ball.prototype.update=function(a,c,b){var d=this.state.u;this.integrate(a,c);a=this.state.u-d;this.nx+=a*Math.cos(this.direction);this.ny+=a*Math.sin(this.direction);this.bounce(b)};
Ball.prototype.bounce=function(a){this.nx>1-this.nr?(this.nx=1-this.nr,this.direction=normalizeRadian(Math.PI-this.direction)):this.nx<this.nr&&(this.nx=this.nr,this.direction=normalizeRadian(Math.PI-this.direction));this.ny>1-this.nr&&(this.ny=1-this.nr,this.direction=normalizeRadian(-this.direction));for(var c=0;c<a.length;++c){var b=a[c],d=this.nx-b.nx,f=this.ny-b.ny,h=vectorLength(d,f);h<=b.nr+this.nr&&(--b.counter,this.nx=b.nx+d*(this.nr+b.nr)/h,this.ny=b.ny+f*(this.nr+b.nr)/h,d=Math.atan2(f,
d),f=this.direction,h=this.state.s,b=-h*Math.cos(f-d)*Math.cos(d)+h*Math.sin(f-d)*Math.cos(d+Math.PI/2),d=-h*Math.cos(f-d)*Math.sin(d)+h*Math.sin(f-d)*Math.sin(d+Math.PI/2),this.direction=Math.atan2(d,b))}};Ball.prototype.grow=function(a){for(var c=Number.MAX_VALUE,b,d=0;d<a.length;++d)b=a[d],b=vectorLength(this.nx-b.nx,this.ny-b.ny)-b.nr,c>b&&(c=b);b=this.nx;c>b&&(c=b);b=1-this.nx;c>b&&(c=b);b=Math.abs(this.ny);c>b&&(c=b);b=Math.abs(1-this.ny);c>b&&(c=b);this.nr=Math.abs(c)};
function DontYouFillItGame(){this.state=this.PAUSED();this.cannon=new Cannon;this.staticBalls=[];this.currentBall=null;this.lastUpdateTime=performance.now?performance.now():Date.now();this.highscore=localStorage.getItem("highscore");this.highscore=null==this.highscore?0:parseInt(this.highscore,10);this.score=0;this.newHighscore=!1}DontYouFillItGame.prototype.PAUSED=function(){return 1};DontYouFillItGame.prototype.RUNNING=function(){return 2};DontYouFillItGame.prototype.GAMEOVER=function(){return 3};
DontYouFillItGame.prototype.update=function(a){if(this.currentBall)for(var c=this.lastUpdateTime,b=Math.floor(a-this.lastUpdateTime),d,f=1;f<=b;++f){d=(this.lastUpdateTime*(b-f)+a*f)/b;this.currentBall.update(c/1E3,(d-c)/1E3,this.staticBalls);for(c=this.staticBalls.length-1;0<=c;--c)0==this.staticBalls[c].counter&&(++this.score,this.staticBalls.splice(c,1));if(this.currentBall.ny<this.currentBall.nr&&normalizeRadian(this.currentBall.direction)>Math.PI){this.currentBall.state.s=0;if(this.newHighscore=
this.score>this.highscore)this.highscore=this.score,localStorage.setItem("highscore",this.score.toString(10));this.state=this.GAMEOVER()}else if(0.001>this.currentBall.state.s){0<=this.currentBall.ny&&(this.currentBall.grow(this.staticBalls),this.staticBalls.push(this.currentBall));this.currentBall=null;break}c=d}this.cannon.update(this.lastUpdateTime/1E3,(a-this.lastUpdateTime)/1E3);this.lastUpdateTime=a};DontYouFillItGame.prototype.pause=function(){this.state=this.PAUSED()};
DontYouFillItGame.prototype.resume=function(){this.lastUpdateTime=performance.now?performance.now():Date.now();this.state=this.RUNNING()};DontYouFillItGame.prototype.reset=function(){this.currentBall=null;this.staticBalls=[];this.score=this.cannon.state.u=0;this.resume()};DontYouFillItGame.prototype.fire=function(){this.currentBall=new Ball(0.025,0.5+Math.cos(this.cannon.getAngle())/15,-1/6+1/15+Math.sin(this.cannon.getAngle())/15,this.cannon.getAngle())};function DontYouFillItCanvasGui(a,c){function b(a){return a}function d(a){a.moveTo(arguments[1],arguments[2]);for(var b=3;b<arguments.length;b+=2)a.lineTo(arguments[b],arguments[b+1])}function f(a,c){var e=c.nx*k,f=-c.ny*k,l=c.nr*k,m=32<l?Math.floor:b,h=32<l?Math.ceil:b;a.fillStyle="white";a.strokeStyle="white";a.lineWidth=1;a.beginPath();a.arc(e,f,l,0,2*Math.PI,!1);if(1==c.counter){var g=m(e-0.2*l),n=h(e+0.2*l),e=m(f-0.7*l),p=h(f+0.7*l);d(a,g,e,g,p,n,p,n,e)}else if(2==c.counter){var g=m(e-0.5*l),
n=m(e-0.1*l),q=h(e+0.1*l),t=h(e+0.5*l),e=m(f-0.7*l),p=m(f-0.3*l),m=m(f-0.15*l),r=h(f+0.15*l),u=h(f+0.3*l),f=h(f+0.7*l);d(a,t,e,g,e,g,p,q,p,q,m,g,m,g,f,t,f,t,u,n,u,n,r,t,r)}else 3==c.counter&&(g=m(e-0.5*l),n=h(e+0.1*l),q=h(e+0.5*l),e=m(f-0.7*l),p=m(f-0.3*l),m=m(f-0.15*l),r=h(f+0.15*l),u=h(f+0.3*l),f=h(f+0.7*l),d(a,q,e,g,e,g,p,n,p,n,m,g,m,g,r,n,r,n,u,g,u,g,f,q,f));a.closePath();a.fill()}function h(a){u.androidStockCompat?(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.canvas.style.display="none",
a.canvas.offsetHeight,a.canvas.style.display="inherit"):a.clearRect(0,0,a.canvas.width,a.canvas.height)}function n(b){u.observable.notifyObservers("beginStep");a.state==a.RUNNING()&&a.update(b);if(u.state==u.GAME){if(r||void 0===z||z.score!=a.score){b=q;b.fillStyle="black";b.fillRect(0,0,b.canvas.width,b.canvas.height);b.fillStyle="white";b.textAlign="left";b.textBaseline="bottom";b.font=L;b.fillText("Highscore",B,A-k/12+k/120);b.fillText("Score",B,A);var c=b.measureText("Highscore ").width;b.fillText(a.highscore,
B+c,A-k/12+k/120);b.fillText(a.score,B+c,A)}if(r){b=v;b.fillStyle="black";b.fillRect(0,0,b.canvas.width,b.canvas.height);var c=Math.floor(0.1*(k/6)),d=Math.floor(0.6*(k/6)),g=Math.floor(0.1*(k/6)),l=Math.floor(0.3*(k/6)),m=Math.floor(0.8*(k/6));b.fillStyle="white";b.fillRect(c,g,l,m);b.fillRect(d,g,l,m)}if(void 0!=z)for(b=0;b<z.previousBalls.length;++b)c=z.previousBalls[b],0==c.counter&&(t.push(c.ctx),delete c.ctx);for(b=0;b<a.staticBalls.length;++b){c=a.staticBalls[b];m=c.nr*k;d=Math.floor(c.nx*
k-m-1);g=Math.floor(-c.ny*k-m-1);l=!1;if(r||void 0===c.ctx){void 0===c.ctx&&(0==t.length?(c.ctx=document.createElement("canvas").getContext("2d"),c.ctx.canvas.classList.add("ball"),E.appendChild(c.ctx.canvas)):c.ctx=t.pop());var m=Math.ceil(2*m)+2,s=c.ctx.canvas;if(s.width!=m||s.height!=m)s.width=m,s.height=m,l=!0;c.ctx.canvas.style.left=d-1+"px";c.ctx.canvas.style.top=k-1+g+"px";c.ctx.canvas.style.display="block"}if(r||void 0===c.was||c.was!=c.counter)c.was=c.counter,c.ctx.setTransform(1,0,0,1,0,
0),l||h(c.ctx),c.ctx.translate(-d,-g),f(c.ctx,c)}for(b=0;b<t.length;++b)"none"!=t[b].canvas.style.display&&(t[b].canvas.style.display="none");r=!1;h(p);p.setTransform(1,0,0,1,0,0);p.translate(-k/2+G/2,-H+I);b=p;c=Math.round(Q/2);d=Math.round(k/2);g=d-c;l=d+c;m=Math.round(J+k/6);s=Math.round(J+k/6-M);b.lineWidth=K;b.fillStyle="white";b.strokeStyle="white";b.lineCap="butt";b.beginPath();b.moveTo(g,m);b.lineTo(g,s);b.arc(d,s,c,Math.PI,0);b.lineTo(l,m);b.closePath();b.fill();b.beginPath();b.moveTo(d,
s);b.lineTo(d+Math.cos(a.cannon.getAngle())*F,s-Math.sin(a.cannon.getAngle())*F);b.closePath();b.stroke();p.setTransform(1,0,0,1,0,0);a.currentBall?(c=a.currentBall.nr*k,b=Math.floor(a.currentBall.nx*k-c-N),c=Math.floor(-a.currentBall.ny*k-c-N),e.setTransform(1,0,0,1,0,0),h(e),e.save(),e.translate(-b,-c),f(e,a.currentBall),e.restore(),e.canvas.style.left=C+Math.floor(B)+b+"px",e.canvas.style.top=D+Math.floor(J)+c+"px",e.canvas.style.display="block"):e.canvas.style.display="none";z={previousBalls:a.staticBalls.slice(),
score:a.score}}u.observable.notifyObservers("endStep");if(a.state==a.RUNNING())window.requestAnimationFrame(n);else if(a.state==a.GAMEOVER()){u.observable.notifyObservers("gameover",a.score,a.newHighscore);for(b=0;b<a.staticBalls.length;++b)t.push(a.staticBalls[b].ctx),delete a.staticBalls[b].ctx}}function g(){a.state==a.RUNNING()&&(a.pause(),u.observable.notifyObservers("pause"))}function s(){var b=x.clientWidth,c=x.clientHeight;O=k=0.75>b/c?b:Math.floor(0.75*c);H=Math.floor(4/3*k);D=Math.floor((c-
H)/2);C=Math.floor((b-O)/2);A=Math.floor(k/6);J=A+k;B=0;Q=k/10;M=k/15;F=k/15;K=k/18;P=Math.ceil(k/20)+2*N;b=Math.sqrt(K/2*(K/2)+F*F);G=Math.ceil(2*b);I=Math.ceil(M+b);L=Math.floor(k/12)+"px Arial";q.font=L;q.canvas.width=Math.ceil(q.measureText("Highscore XXXX").width);q.canvas.height=Math.ceil(k/6);q.canvas.style.left=C+"px";q.canvas.style.top=D+"px";v.canvas.width=Math.ceil(k/6);v.canvas.height=Math.ceil(k/6);v.canvas.style.left=C+O-Math.ceil(k/6)+"px";v.canvas.style.top=D+"px";p.canvas.width=G;
p.canvas.height=I;p.canvas.style.left=Math.ceil(C+(k-G)/2)+"px";p.canvas.style.top=Math.floor(D+H-I)+"px";e.canvas.width=P;e.canvas.height=P;E.style.width=k-2+"px";E.style.height=k-2+"px";E.style.left=C+"px";E.style.top=D+A+"px";r=!0;a.state!=a.RUNNING()&&window.requestAnimationFrame(n)}function w(a){if(500>a.timeStamp-R)return!0;R=a.timeStamp;return!1}function y(a,b){var c="string"===typeof a?document.getElementById(a):a;c.addEventListener("click",b);c.addEventListener("touchstart",b,supportsPassive?
{passive:!1}:!1)}var u=this,t=[],r=!0;this.MENU=1;this.GAME=2;this.state=this.MENU;this.game=a;this.observable=new Observable;var q=document.getElementById("ScoreCanvas").getContext("2d"),v=document.getElementById("PauseCanvas").getContext("2d"),p=document.getElementById("CannonCanvas").getContext("2d"),e=document.getElementById("BallCanvas").getContext("2d"),x=q.canvas.parentNode,E=document.getElementById("Balls"),R=0,z=void 0,k,O,H,D,C,J,A,B,Q,M,F,K,G,I,P,N=8,L;window.addEventListener("resize",
s,!1);y("PauseCanvas",function(a){a.preventDefault();a.stopPropagation();w(a)||g()});y(x,function(b){b.preventDefault();w(b)||null==a.currentBall&&a.state==a.RUNNING()&&a.fire()});document.addEventListener("visibilitychange",function(){document.hidden&&g()},!1);this.resume=function(){a.resume();this.state=this.GAME;window.requestAnimationFrame(n)};this.reset=function(){z=void 0;a.reset();window.requestAnimationFrame(n)};s();window.requestAnimationFrame(n)}
DontYouFillItCanvasGui.prototype.addObserver=function(a){this.observable.addObserver(a)};DontYouFillItCanvasGui.prototype.removeObserver=function(a){this.observable.removeObserver(a)};DontYouFillItCanvasGui.prototype.notifyObservers=function(){this.observable.notifyObservers()};var game=new DontYouFillItGame,gui=new DontYouFillItCanvasGui(game,"c");function parseQueryString(){for(var a={},c=window.location.search.substring(1).split("&"),b=0;b<c.length;b++){var d=c[b].split("=",2);a[d[0]]=2==d.length?d[1]:!0}return a}var qs=parseQueryString();
if(qs.debug){var stats=new Stats;stats.showPanel(0);stats.dom.style.removeProperty("top");stats.dom.style.position="fixed";stats.dom.style.left="0px";stats.dom.style.bottom="0px";document.body.appendChild(stats.dom);gui.addObserver(function(a){"beginStep"==a?stats.begin():"endStep"==a&&stats.end()})}gui.androidStockCompat=!0==qs.stock;
var screenContainer=document.getElementById("screenContainer"),startScreen=document.getElementById("startScreen"),pauseScreen=document.getElementById("pauseScreen"),gameoverScreen=document.getElementById("gameoverScreen"),licenseScreen=document.getElementById("licenseScreen"),screens=[];
function pushScreen(a){0!=screens.length&&(screens[screens.length-1].style.display="none");screens.push(a);a.style.zIndex=screens.length;a.style.visibility="hidden";a.style.display="block";a.scrollTop=0;a.style.visibility="visible";screenContainer.style.display="block";screenContainer.style.backgroundColor=a==pauseScreen?"rgba(0, 0, 0, 0.85)":"black"}
function popScreen(){0!=screens.length&&(screens.pop().style.display="none",0==screens.length?screenContainer.style.display="none":screens[screens.length-1].style.display="block")}function popAllScreens(){for(;0<screens.length;)screens.pop().style.display="none";screenContainer.style.display="none"}document.getElementById("startScreenPlayButton").addEventListener("click",function(a){a.preventDefault();gui.resume();popAllScreens()});
document.getElementById("pauseScreenContinueButton").addEventListener("click",function(a){a.preventDefault();gui.resume();popScreen()});document.getElementById("gameoverScreenPlayAgainButton").addEventListener("click",function(a){a.preventDefault();gui.reset();popAllScreens()});document.getElementById("startScreenLicenseButton").addEventListener("click",function(a){a.preventDefault();pushScreen(licenseScreen)});
document.getElementById("licenseScreenBackButton").addEventListener("click",function(a){a.preventDefault();popScreen();licenseScreen.reset()});gui.addObserver(function(a){"pause"==a&&pushScreen(pauseScreen)});gui.addObserver(function(a,c,b){"gameover"==a&&(document.getElementById("gameoverScreenScoreMessage").style.display=b?"none":"inline",document.getElementById("gameoverScreenHighscoreMessage").style.display=b?"inline":"none",document.getElementById("gameoverScreenScore").innerHTML=c,pushScreen(gameoverScreen))});
pushScreen(startScreen);function setNodeText(a,c){var b=a.firstChild;do if(3==b.nodeType){b.nodeValue=c;break}while(b=b.nextSibling)}
Array.prototype.forEach.call(document.getElementsByClassName("hideable"),function(a){var c=function(b){Array.prototype.forEach.call(document.getElementsByClassName(a.getAttribute("data-toggle")),b)};a.reset=function(){this.style.display="none";c(function(a){setNodeText(a,"[-]")})};c(function(b){b.addEventListener("click",function(b){var f="none"!=a.style.display;c(function(a){setNodeText(a,f?"[+]":"[-]")});a.style.display=f?"none":"block";b.preventDefault()})});a.style.display="none"});
document.getElementById("licenseScreen").reset=function(){Array.prototype.forEach.call(this.getElementsByClassName("hideable"),function(a){a.reset()})};
